<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="test-token">
    <title>Final Modal Test</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="assets/css/style.css" rel="stylesheet" />
    <style>
        body { padding: 20px; font-family: Arial, sans-serif; background: #f8f9fa; }
        .test-container { max-width: 800px; margin: 0 auto; }
        .test-card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .test-btn { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 16px;
            margin: 10px;
            transition: transform 0.2s;
        }
        .test-btn:hover { transform: translateY(-2px); }
        .status-card { 
            padding: 20px; 
            margin: 15px 0; 
            border-radius: 8px; 
            border-left: 4px solid #007bff;
            background: #f8f9fa;
        }
        .success { border-left-color: #28a745; background: #d4edda; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .form-demo { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            margin: 20px 0; 
            padding: 15px; 
            background: #f8f9fa; 
            border-radius: 8px;
        }
        .form-demo select { 
            flex: 1; 
            padding: 8px 12px; 
            border: 1px solid #ddd; 
            border-radius: 6px; 
        }
        .add-btn { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 8px 12px; 
            border-radius: 6px; 
            cursor: pointer; 
        }
        .add-btn:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-card">
            <h1>üß™ Final Modal Test - HKBP Setia Mekar</h1>
            <p>Test modal kategori dengan CSS yang sudah diperbaiki</p>
            
            <div class="status-card" id="status">
                Status: Memuat...
            </div>
            
            <div class="form-demo">
                <label>Kategori:</label>
                <select id="kategori_select">
                    <option value="">-- Pilih Kategori --</option>
                    <option value="1">Perlengkapan Ibadah</option>
                    <option value="2">Peralatan Sound</option>
                    <option value="3">Furniture Gereja</option>
                </select>
                <button type="button" onclick="console.log('Button clicked!'); toggleCategoryModal();" class="add-btn">
                    <i class="fas fa-plus"></i> Tambah
                </button>
            </div>
            
            <button class="test-btn" onclick="testModal()">
                <i class="fas fa-play"></i> Test Modal
            </button>
            
            <button class="test-btn" onclick="testDirectShow()">
                <i class="fas fa-eye"></i> Force Show Modal
            </button>
            
            <button class="test-btn" onclick="testElements()">
                <i class="fas fa-search"></i> Check Elements
            </button>
        </div>
    </div>

    <!-- Modal Kategori -->
    <div id="categoryModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50" style="display: none; z-index: 99999;">
      <div class="relative w-full max-w-md mx-4">
        <div class="relative bg-white rounded-2xl shadow-soft-xl">
          <div class="flex items-center justify-between p-6 border-b border-gray-200 rounded-t-2xl">
            <h3 class="text-lg font-semibold text-slate-700">Tambah Kategori</h3>
            <button type="button" onclick="closeCategoryModal()" 
                    class="text-gray-400 hover:text-gray-600 transition-colors">
              <i class="fas fa-times text-lg"></i>
            </button>
          </div>
          <div class="p-6">
            <form id="quickAddCategory">
              <div class="mb-4">
                <label class="block text-sm font-semibold text-slate-700 mb-2">Nama Kategori</label>
                <input type="text" name="nama" id="kategori_nama" required
                       placeholder="Masukkan nama kategori..."
                       class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out">
                <div class="error-message text-red-500 text-xs mt-1" id="nama-error" style="display: none;"></div>
              </div>
              <div class="mb-4">
                <label class="block text-sm font-semibold text-slate-700 mb-2">Deskripsi (opsional)</label>
                <textarea name="deskripsi" rows="3" placeholder="Masukkan deskripsi kategori..."
                          class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out"></textarea>
              </div>
            </form>
          </div>
          <div class="flex items-center justify-end p-6 space-x-3 border-t border-gray-200 rounded-b-2xl">
            <button type="button" onclick="closeCategoryModal()"
                    class="inline-block px-6 py-3 font-bold text-center text-white uppercase align-middle transition-all rounded-lg cursor-pointer bg-gradient-to-tl from-gray-400 to-gray-600 leading-pro text-xs ease-soft-in tracking-tight-soft shadow-soft-md bg-150 bg-x-25 hover:scale-102 active:opacity-85 hover:shadow-soft-xs">
              Batal
            </button>
            <button type="button" onclick="testSubmit()"
                    class="inline-block px-6 py-3 font-bold text-center text-white uppercase align-middle transition-all rounded-lg cursor-pointer bg-gradient-to-tl from-blue-600 to-cyan-400 leading-pro text-xs ease-soft-in tracking-tight-soft shadow-soft-md bg-150 bg-x-25 hover:scale-102 active:opacity-85 hover:shadow-soft-xs"
                    id="submitCategoryBtn">
              <span class="btn-text">Test Submit</span>
              <span class="btn-loading" style="display: none;">
                <i class="fas fa-spinner fa-spin mr-2"></i>Testing...
              </span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="assets/js/soft-ui-dashboard-tailwind.js"></script>
    <script>
    function updateStatus(message, type = 'info') {
        const statusDiv = document.getElementById('status');
        statusDiv.innerHTML = message;
        statusDiv.className = `status-card ${type}`;
    }

    function testModal() {
        updateStatus('üß™ Testing toggleCategoryModal()...');
        try {
            if (typeof toggleCategoryModal === 'function') {
                toggleCategoryModal();
                updateStatus('‚úÖ Modal function called successfully! Modal should be visible now.', 'success');
            } else {
                updateStatus('‚ùå toggleCategoryModal function not found!', 'error');
            }
        } catch (error) {
            updateStatus('‚ùå Error: ' + error.message, 'error');
        }
    }

    function testDirectShow() {
        updateStatus('üîß Force showing modal with CSS...');
        const modal = document.getElementById('categoryModal');
        if (modal) {
            modal.style.display = 'flex';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.right = '0';
            modal.style.bottom = '0';
            modal.style.zIndex = '999999';
            modal.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
            updateStatus('‚úÖ Modal forced to show! If you can see it, CSS is working.', 'success');
        } else {
            updateStatus('‚ùå Modal element not found!', 'error');
        }
    }

    function testElements() {
        const modal = document.getElementById('categoryModal');
        const input = document.getElementById('kategori_nama');
        const form = document.getElementById('quickAddCategory');
        const select = document.getElementById('kategori_select');
        
        let results = [];
        results.push(modal ? '‚úÖ Modal element found' : '‚ùå Modal element missing');
        results.push(input ? '‚úÖ Input element found' : '‚ùå Input element missing');
        results.push(form ? '‚úÖ Form element found' : '‚ùå Form element missing');
        results.push(select ? '‚úÖ Select element found' : '‚ùå Select element missing');
        
        const functions = ['toggleCategoryModal', 'closeCategoryModal', 'submitNewCategory'];
        functions.forEach(func => {
            results.push(typeof window[func] === 'function' ? `‚úÖ ${func} function available` : `‚ùå ${func} function missing`);
        });
        
        updateStatus(results.join('<br>'), results.some(r => r.includes('‚ùå')) ? 'error' : 'success');
    }

    function testSubmit() {
        const input = document.getElementById('kategori_nama');
        if (!input.value.trim()) {
            alert('Masukkan nama kategori untuk test!');
            return;
        }
        
        // Add to dropdown
        const select = document.getElementById('kategori_select');
        const option = new Option(input.value, Date.now(), true, true);
        select.add(option);
        
        alert('‚úÖ Test Submit berhasil! Kategori "' + input.value + '" ditambahkan ke dropdown.');
        closeCategoryModal();
        updateStatus('‚úÖ Test submit completed successfully!', 'success');
    }

    // Auto-run tests when page loads
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
            testElements();
        }, 1000);
    });
    </script>
</body>
</html>