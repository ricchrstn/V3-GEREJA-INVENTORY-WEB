<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="test-token">
    <title>Simple Modal Test</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="assets/css/style.css" rel="stylesheet" />
    <style>
        body { padding: 20px; font-family: Arial, sans-serif; }
        .test-btn { 
            background: #007bff; 
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px;
            margin: 10px;
        }
        .test-btn:hover { background: #0056b3; }
        .status { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            background: #f8f9fa; 
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <h1>üß™ Simple Modal Test</h1>
    
    <div class="status" id="status">
        Status: Loading...
    </div>
    
    <button class="test-btn" onclick="testModal()">
        <i class="fas fa-plus"></i> Test Modal
    </button>
    
    <button class="test-btn" onclick="testDirectly()">
        <i class="fas fa-cog"></i> Test Direct Show
    </button>

    <!-- Dropdown untuk test -->
    <div style="margin: 20px 0;">
        <label>Test Kategori Dropdown:</label>
        <select id="kategori_select" style="padding: 8px; margin: 0 10px;">
            <option value="">-- Pilih Kategori --</option>
            <option value="1">Elektronik</option>
            <option value="2">Furniture</option>
        </select>
        <button type="button" onclick="console.log('Button clicked!'); toggleCategoryModal();"
                style="padding: 8px 12px; background: #007bff; color: white; border: none; border-radius: 4px;">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- Modal -->
    <div id="categoryModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50" style="display: none; z-index: 99999;">
      <div class="relative w-full max-w-md mx-4">
        <div class="relative bg-white rounded-2xl shadow-soft-xl">
          <div class="flex items-center justify-between p-6 border-b border-gray-200 rounded-t-2xl">
            <h3 class="text-lg font-semibold text-slate-700">Tambah Kategori</h3>
            <button type="button" onclick="closeCategoryModal()" 
                    class="text-gray-400 hover:text-gray-600 transition-colors">
              <i class="fas fa-times text-lg"></i>
            </button>
          </div>
          <div class="p-6">
            <form id="quickAddCategory">
              <div class="mb-4">
                <label class="block text-sm font-semibold text-slate-700 mb-2">Nama Kategori</label>
                <input type="text" name="nama" id="kategori_nama" required
                       placeholder="Masukkan nama kategori..."
                       class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out">
                <div class="error-message text-red-500 text-xs mt-1" id="nama-error" style="display: none;"></div>
              </div>
            </form>
          </div>
          <div class="flex items-center justify-end p-6 space-x-3 border-t border-gray-200 rounded-b-2xl">
            <button type="button" onclick="closeCategoryModal()"
                    class="px-4 py-2 bg-gray-500 text-white rounded">Batal</button>
            <button type="button" onclick="testSubmit()"
                    class="px-4 py-2 bg-blue-500 text-white rounded">Test Submit</button>
          </div>
        </div>
      </div>
    </div>

    <script src="assets/js/soft-ui-dashboard-tailwind.js"></script>
    <script>
    function updateStatus(message) {
        document.getElementById('status').innerHTML = 'Status: ' + message;
    }

    function testModal() {
        updateStatus('Testing toggleCategoryModal()...');
        try {
            if (typeof toggleCategoryModal === 'function') {
                toggleCategoryModal();
                updateStatus('‚úÖ Modal function called successfully!');
            } else {
                updateStatus('‚ùå toggleCategoryModal function not found!');
            }
        } catch (error) {
            updateStatus('‚ùå Error: ' + error.message);
        }
    }

    function testDirectly() {
        updateStatus('Testing direct modal show...');
        const modal = document.getElementById('categoryModal');
        if (modal) {
            modal.style.display = 'flex';
            updateStatus('‚úÖ Modal shown directly!');
        } else {
            updateStatus('‚ùå Modal element not found!');
        }
    }

    function testSubmit() {
        const input = document.getElementById('kategori_nama');
        if (input.value.trim()) {
            alert('Test Submit: ' + input.value);
            
            // Add to dropdown
            const select = document.getElementById('kategori_select');
            const option = new Option(input.value, Date.now(), true, true);
            select.add(option);
            
            closeCategoryModal();
            updateStatus('‚úÖ Category added to dropdown!');
        } else {
            alert('Please enter a category name!');
        }
    }

    // Check when page loads
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
            const modal = document.getElementById('categoryModal');
            const functions = ['toggleCategoryModal', 'closeCategoryModal'];
            
            let status = 'üìä Check Results:<br>';
            status += modal ? '‚úÖ Modal element found<br>' : '‚ùå Modal element missing<br>';
            
            functions.forEach(func => {
                status += typeof window[func] === 'function' ? `‚úÖ ${func} available<br>` : `‚ùå ${func} missing<br>`;
            });
            
            updateStatus(status);
        }, 1000);
    });
    </script>
</body>
</html>